<!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "28a5f7c0617a4f8aab97e95c1ea3e1b7"}'></script><!-- End Cloudflare Web Analytics -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WFQQ172YYK"></script>

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>TalkBetterï½œConjunction Practice</title>

<style>
:root{
  --bg:#f6f7ff; --card:#fff; --border:#e5e7f5;
  --text:#1f2937; --sub:#6b7280;
  --blue:#4a6fdc; --blueSoft:#eef2ff;
  --green:#16a34a; --greenSoft:#ecfdf5;
  --red:#dc2626; --redSoft:#fef2f2;
  --shadow:0 14px 34px rgba(31,41,55,.10);
  --r:20px;
  --tap:58px;
}
*{box-sizing:border-box}
body{
  margin:0; padding:16px 14px 26px;
  font-family: system-ui,-apple-system,"Segoe UI","Noto Sans TC","Microsoft JhengHei",sans-serif;
  background:var(--bg); color:var(--text);
}
.app{max-width:780px;margin:0 auto}

.top{
  display:flex; align-items:flex-end; justify-content:space-between;
  gap:10px; margin:6px 2px 14px;
}
.title h1{margin:0;font-size:20px}
.title p{margin:6px 0 0;color:var(--sub);font-size:13px}
.pill{
  background:var(--blueSoft); color:var(--blue);
  padding:8px 12px; border-radius:999px;
  font-size:13px;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--r);
  box-shadow:var(--shadow);
  padding:18px 16px 16px;
}

.qRow{
  display:flex; justify-content:space-between;
  margin-bottom:10px
}
.qNo{font-size:13px;color:var(--sub)}

.questionBox{
  margin:6px 0 12px;
  padding:12px;
  border-radius:16px;
  border:1px solid var(--border);
  background:#fff;
}
.qLabel{font-size:12px;color:var(--sub);margin-bottom:6px}
.qText{font-size:18px;font-weight:800;line-height:1.4}

.sentence{
  font-size:20px;
  line-height:1.55;
  padding:12px;
  border-radius:16px;
  background:#fafbff;
  border:1px dashed var(--border);
  transition:.18s transform,.18s box-shadow,.18s border-color,.18s background;
}
.sentence.win{
  border-color:#22c55e;
  background:#f0fdf4;
  box-shadow:0 18px 44px rgba(34,197,94,.18);
  transform: translateY(-1px);
}
.sentence.lose{
  border-color:#ef4444;
  background:#fef2f2;
}

.blank{
  padding:2px 10px;
  border-radius:999px;
  border:2px solid var(--blue);
  color:var(--blue);
  font-weight:900;
}

/* âœ… é¡Œç›®ç­”å°ï¼šæ›´æ˜é¡¯çš„æ‰“å‹¾ Badge */
.stamp{
  margin-top:12px;
  display:none;
  align-items:center;
  justify-content:center;
  gap:10px;
  border-radius:18px;
  padding:12px 14px;
  border:2px solid rgba(34,197,94,.45);
  background:linear-gradient(180deg,#ffffff,#f3fff7);
  box-shadow:0 16px 40px rgba(34,197,94,.14);
}
.stamp.show{display:flex}
.check{
  width:42px;height:42px;
  border-radius:999px;
  background:#22c55e;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  font-weight:1000;
  box-shadow:0 10px 24px rgba(34,197,94,.25);
  transform: translateZ(0);
}
.stampText{
  font-size:18px;
  font-weight:1000;
  color:#15803d;
  letter-spacing:.2px;
}

/* âœ… ä¸­æ–‡æç¤ºï¼šåŠ å¤§ã€é¡è‰²æ¸…æ¥š */
.zh{
  margin-top:12px;
  font-size:22px;
  font-weight:800;
  line-height:1.75;
  color:#1e3a8a;
  background:#eef4ff;
  border:2px solid #c7d7ff;
  border-radius:16px;
  padding:14px 16px;
  display:none;
}

.toolsRow{
  display:flex; justify-content:flex-end;
  margin-top:10px;
}
.tbtn{
  border:1px solid var(--border);
  background:#fff;
  padding:8px 12px;
  border-radius:999px;
  font-size:13px;
  color:var(--sub);
  cursor:pointer;
}

.btns{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
  margin-top:16px;
}
.btn{
  height:var(--tap);
  border-radius:16px;
  border:1.5px solid var(--border);
  background:#fff;
  font-size:18px;
  font-weight:900;
  cursor:pointer;
  transition:.12s transform,.12s box-shadow,.12s border-color;
}
.btn:active{transform:scale(.98)}
.btn.correct{
  background:var(--greenSoft);
  border-color:var(--green);
  color:var(--green);
  box-shadow:0 0 0 4px rgba(22,163,74,.16) inset, 0 10px 22px rgba(22,163,74,.10);
}
.btn.wrong{
  background:var(--redSoft);
  border-color:var(--red);
  color:var(--red);
  box-shadow:0 0 0 4px rgba(220,38,38,.12) inset;
}
.btn[disabled]{cursor:not-allowed; opacity:.92}

.feedback{
  margin-top:12px;
  padding:12px;
  border-radius:16px;
  background:#fff;
  display:none;
  border:1px solid var(--border);
}
.feedback.good{
  border-color: rgba(34,197,94,.35);
  background: linear-gradient(180deg,#ffffff,#f3fff7);
}
.feedback.bad{
  border-color: rgba(239,68,68,.28);
  background: linear-gradient(180deg,#ffffff,#fff6f6);
}
.fbTitle{font-size:16px;font-weight:1000;margin:0 0 6px}
.full{font-size:16px; line-height:1.55}

.nav{
  margin-top:14px;
  display:flex; justify-content:flex-end;
}
.next{
  height:48px;
  padding:0 16px;
  border:none;
  border-radius:14px;
  background:var(--blue);
  color:#fff;
  font-size:15px;
  font-weight:900;
  cursor:pointer;
}
.next:disabled{opacity:.4}

/* âœ… å®Œæˆæç¤ºï¼ˆå…¨é¡Œåšå®Œï¼‰ */
.doneOverlay{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  padding:18px;
  background:rgba(15,23,42,.45);
  backdrop-filter: blur(3px);
  z-index:9999;
}
.doneOverlay.show{display:flex}
.doneCard{
  width:min(520px, 100%);
  background:#fff;
  border:1px solid var(--border);
  border-radius:22px;
  box-shadow:0 22px 60px rgba(2,6,23,.20);
  padding:18px 16px 16px;
}
.doneTitle{
  margin:0 0 6px;
  font-size:20px;
  font-weight:1000;
}
.doneText{
  margin:0;
  font-size:15px;
  color:var(--sub);
  line-height:1.6;
}
.doneBtns{
  margin-top:14px;
  display:flex;
  justify-content:flex-end;
  gap:10px;
}
.doneBtn{
  height:44px;
  padding:0 14px;
  border-radius:14px;
  border:1px solid var(--border);
  background:#fff;
  cursor:pointer;
  font-weight:900;
}
.doneBtn.primary{
  border:none;
  background:var(--blue);
  color:#fff;
}
</style>
</head>

<body>
<div class="app">
  <div class="top">
    <div class="title">
      <h1>TalkBetterï½œConjunction Practice</h1>
      <p>é¸ because / and / butï¼Œç­”å®Œæœƒé¡¯ç¤ºä¸­æ–‡</p>
    </div>
    <div class="pill" id="progressPill">1 / 40</div>
  </div>

  <div class="card">
    <div class="qRow">
      <div class="qNo" id="qNo">Question 1</div>
    </div>

    <div class="questionBox">
      <div class="qLabel">Question</div>
      <div class="qText" id="qText"></div>
    </div>

    <div class="sentence" id="sentenceBox"></div>

    <!-- âœ… ç­”å°æ‰“å‹¾æ›´æ˜é¡¯ -->
    <div class="stamp" id="stamp">
      <div class="check">âœ“</div>
      <div class="stampText" id="stampText">ç­”å°ï¼å¤ªæ£’äº†ï¼</div>
    </div>

    <div class="toolsRow">
      <button class="tbtn" id="toggleZhBtn">é¡¯ç¤ºä¸­æ–‡</button>
    </div>
    <div class="zh" id="zhBox"></div>

    <div class="btns" id="btns"></div>

    <div class="feedback" id="feedback">
      <p class="fbTitle" id="fbTitle"></p>
      <div class="full" id="fullSentence"></div>
    </div>

    <div class="nav">
      <button class="next" id="nextBtn" disabled>Next â–¶</button>
    </div>
  </div>
</div>

<!-- âœ… å®Œæˆæç¤º -->
<div class="doneOverlay" id="doneOverlay">
  <div class="doneCard">
    <h2 class="doneTitle">ğŸ‰ å…¨éƒ¨å®Œæˆï¼</h2>
    <p class="doneText" id="doneText">ä½ å·²å®Œæˆæœ¬æ¬¡ç·´ç¿’ã€‚è¦å†ä¾†ä¸€è¼ªå—ï¼Ÿï¼ˆé‡æ–°é–‹å§‹æœƒé‡æ–°æ´—ç‰Œï¼‰</p>
    <div class="doneBtns">
      <button class="doneBtn" id="closeDoneBtn">é—œé–‰</button>
      <button class="doneBtn primary" id="restartBtn">å†ç·´ä¸€æ¬¡</button>
    </div>
  </div>
</div>

<script src="./data.js"></script>
<script>
const CHOICES=["because","and","but"];
const DATA=[...(window.TALKBetter_DATA||[])];

function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
}
shuffle(DATA);

let idx=0;

const pill=document.getElementById("progressPill");
const qNo=document.getElementById("qNo");
const qText=document.getElementById("qText");
const sentenceBox=document.getElementById("sentenceBox");
const zhBox=document.getElementById("zhBox");
const btns=document.getElementById("btns");
const feedback=document.getElementById("feedback");
const fbTitle=document.getElementById("fbTitle");
const fullSentence=document.getElementById("fullSentence");
const nextBtn=document.getElementById("nextBtn");
const stamp=document.getElementById("stamp");
const stampText=document.getElementById("stampText");

const toggleZhBtn=document.getElementById("toggleZhBtn");

const doneOverlay=document.getElementById("doneOverlay");
const closeDoneBtn=document.getElementById("closeDoneBtn");
const restartBtn=document.getElementById("restartBtn");
const doneText=document.getElementById("doneText");

function render(){
  const d=DATA[idx];

  pill.textContent=`${idx+1} / ${DATA.length}`;
  qNo.textContent=`Question ${idx+1}`;
  qText.textContent=d.q || "";

  sentenceBox.className="sentence";
  sentenceBox.innerHTML=`${escapeHtml(d.prefix)} <span class="blank">____</span> ${escapeHtml(d.suffix)}`;

  // reset
  stamp.classList.remove("show");
  stampText.textContent="ç­”å°ï¼å¤ªæ£’äº†ï¼";
  zhBox.style.display="none";
  zhBox.textContent=d.zh || "";
  toggleZhBtn.textContent="é¡¯ç¤ºä¸­æ–‡";

  btns.innerHTML="";
  feedback.style.display="none";
  feedback.className="feedback";
  nextBtn.disabled=true;

  CHOICES.forEach(c=>{
    const b=document.createElement("button");
    b.className="btn";
    b.textContent=c;
    b.onclick=()=>choose(c);
    btns.appendChild(b);
  });
}

toggleZhBtn.onclick=()=>{
  const isHidden = (zhBox.style.display === "none");
  zhBox.style.display = isHidden ? "block" : "none";
  toggleZhBtn.textContent = isHidden ? "éš±è—ä¸­æ–‡" : "é¡¯ç¤ºä¸­æ–‡";
};

function showChinese(){
  zhBox.style.display="block";
  toggleZhBtn.textContent="éš±è—ä¸­æ–‡";
}

function choose(c){
  const d=DATA[idx];
  const buttons=[...btns.children];
  buttons.forEach(b=>b.disabled=true);

  const ok=(c===d.correct);

  buttons.forEach(b=>{
    if(b.textContent===d.correct) b.classList.add("correct");
    if(b.textContent===c && !ok) b.classList.add("wrong");
  });

  // âœ… ä½œç­”å¾Œï¼šä¸­æ–‡ç›´æ¥é¡¯ç¤º
  showChinese();

  // âœ… ç­”å°æ‰“å‹¾æ›´æ˜é¡¯
  if(ok){
    stamp.classList.add("show");
    stampText.textContent="âœ… ç­”å°ï¼å¤ªæ£’äº†ï¼";
  }

  // å›é¥‹
  feedback.style.display="block";
  if(ok){
    feedback.classList.add("good");
    fbTitle.textContent="ğŸ‰ æ­£ç¢ºï¼";
    sentenceBox.classList.add("win");
  }else{
    feedback.classList.add("bad");
    fbTitle.textContent="âŒ å†è©¦ä¸€æ¬¡ï¼ˆçœ‹ç¶ è‰²é‚£å€‹ï¼‰";
    sentenceBox.classList.add("lose");
  }

  fullSentence.textContent=`${d.prefix} ${d.correct} ${d.suffix}`;
  nextBtn.disabled=false;

  // æ‰‹æ©Ÿï¼šè®“å­©å­ç«‹åˆ»çœ‹åˆ°ä¸­æ–‡/å›é¥‹
  setTimeout(()=>feedback.scrollIntoView({behavior:"smooth", block:"nearest"}), 60);
}

nextBtn.onclick=()=>{
  idx++;
  if(idx>=DATA.length){
    // âœ… å®Œæˆæç¤ºï¼ˆä¸å†ç”¨ alertï¼‰
    doneText.textContent = `ä½ å·²å®Œæˆæœ¬æ¬¡ç·´ç¿’ï¼ˆå…± ${DATA.length} é¡Œï¼‰ã€‚è¦å†ä¾†ä¸€è¼ªå—ï¼Ÿ`;
    doneOverlay.classList.add("show");
    nextBtn.disabled = true;
    return;
  }
  render();
};

closeDoneBtn.onclick=()=>{
  doneOverlay.classList.remove("show");
  // ç•™åœ¨å®Œæˆç•«é¢ï¼Œä¸å¼·åˆ¶é‡ä¾†
};

restartBtn.onclick=()=>{
  doneOverlay.classList.remove("show");
  shuffle(DATA);
  idx=0;
  render();
};

function escapeHtml(s){
  return (s||"")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;");
}

render();
</script>
</body>
</html>
